{% load static %}

<!DOCTYPE html>
<html lang="vi">
<head>
    <title>Admin Dashboard | Hệ thống Bầu cử</title>
    <!-- [Meta] -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- [Favicon] icon -->
    <link rel="icon" href="{% static 'images/favicon.svg' %}" type="image/x-icon">
    
    <!-- [Fonts] -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="{% static 'fonts/tabler-icons.min.css' %}">
    <link rel="stylesheet" href="{% static 'fonts/feather.css' %}">
    <link rel="stylesheet" href="{% static 'fonts/fontawesome.css' %}">
    <link rel="stylesheet" href="{% static 'fonts/material.css' %}">

    <!-- [Template CSS Files] -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}" id="main-style-link">
    <link rel="stylesheet" href="{% static 'css/style-preset.css' %}">
</head>

<body>
    <!-- [ Pre-loader ] start -->
    <div class="loader-bg">
        <div class="loader-track">
            <div class="loader-fill"></div>
        </div>
    </div>
    <!-- [ Pre-loader ] End -->
<div class="modal fade" id="customMessageModal" tabindex="-1" aria-labelledby="customMessageModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content shadow-lg">
      <div class="modal-header" id="customMessageModalHeader">
        <h5 class="modal-title" id="customMessageModalLabel">
            <!-- Tiêu đề và icon sẽ được thay đổi bằng JavaScript -->
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body fs-5" id="customMessageModalBody">
               {% if messages %}
        <div id="message-container" style="position: fixed; top: 20px; right: 20px; z-index: 9999;">
          {% for message in messages %}
          <div class="alert {% if message.tags == 'error' %}alert-danger{% else %}alert-info{% endif %} alert-dismissible fade show" role="alert">
              {{ message }}
              <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
          {% endfor %}
        </div>
      {% endif %}
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Đã hiểu</button>
      </div>
    </div>
  </div>
</div>
    <!-- [ Sidebar Menu ] start -->
    <nav class="pc-sidebar">
        <div class="navbar-wrapper">
            <div class="m-header">
                <a href="{% url 'trangchu' %}" class="b-brand text-primary">
                    <!-- Your Logo Here -->
                    <span class="fs-4 fw-bold">Bầu Cử Admin</span>
                </a>
            </div>
            <div class="navbar-content">
                <ul class="pc-navbar">
                    <li class="pc-item pc-caption">
                        <label>Hệ thống</label>
                        <i class="ti ti-dashboard"></i>
                    </li>
                    <li class="pc-item">
                        <a href="{% url 'baucu' %}" class="pc-link">
                            <span class="pc-micon"><i class="ti ti-archive"></i></span>
                            <span class="pc-mtext">Quản lý Bầu Cử</span>
                        </a>
                    </li>
                    <li class="pc-item">
                        <a href="{% url 'ds_user' %}" class="pc-link">
                            <span class="pc-micon"><i class="ti ti-users"></i></span>
                            <span class="pc-mtext">Quản lý Người dùng</span>
                        </a>
                    </li>
                    {% comment %} <li class="pc-item">
                        <a href="{% url 'chart_report' %}" class="pc-link">
                            <span class="pc-micon"><i class="ti ti-chart-bar"></i></span>
                            <span class="pc-mtext">Báo cáo & Phân tích</span>
                        </a>
                    </li> {% endcomment %}
                    <li class="pc-item">
                        <a href="{% url 'lichsu_change' %}" class="pc-link">
                            <span class="pc-micon"><i class="ti ti-history"></i></span>
                            <span class="pc-mtext">Lịch sử Cảnh báo</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- [ Sidebar Menu ] end -->

    <!-- [ Header Topbar ] start -->
    <header class="pc-header">
        <div class="header-wrapper">
            <div class="me-auto pc-mob-drp">
                <!-- Mobile Menu Toggle -->
            </div>
            
            <!-- =============================================================== -->
            <!-- ================ KHU VỰC USER VÀ NÚT ĐĂNG XUẤT ================ -->
            <!-- =============================================================== -->
            <div class="ms-auto">
                <ul class="list-unstyled">
                    <li class="dropdown pc-h-item">
                        <a class="pc-head-link dropdown-toggle arrow-none me-0" data-bs-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
                            <i class="ti ti-user"></i>
                            <span>
                                <span class="user-name ms-2">{{ request.user.username }}</span>
                            </span>
                        </a>
                        <div class="dropdown-menu dropdown-menu-end pc-h-dropdown">
                            <h6 class="px-3 mb-3">Xin chào, {{ request.user.get_full_name|default:request.user.username }}</h6>
                            <a href="{% url 'ds_user' %}" class="dropdown-item">
                                <i class="ti ti-user"></i>
                                <span>Hồ sơ</span>
                            </a>
                            <div class="dropdown-divider"></div>
                            <a href="{% url 'admin_logout' %}" class="dropdown-item">
                                <i class="ti ti-logout"></i>
                                <span>Đăng xuất</span>
                            </a>
                        </div>
                    </li>
                </ul>
            </div>
            <!-- =============================================================== -->
        </div>
    </header>
    <!-- [ Header ] end -->
<!-- [ Header ] end -->
<main>
{% block content %}
        <!-- Nội dung mặc định -->
        <p>Chào mừng đến với TravelGo!</p>
{% endblock %}
</main>


  <footer class="pc-footer">
    <div class="footer-wrapper container-fluid">
      <div class="row">
        <div class="col-sm my-1">
          <p class="m-0"
            >Mantis &#9829; crafted by Team <a href="https://themeforest.net/user/codedthemes" target="_blank">Codedthemes</a> Distributed by <a href="https://themewagon.com/">ThemeWagon</a>.</p
          >
        </div>
        <div class="col-auto my-1">
          {% comment %} <ul class="list-inline footer-link mb-0">
            <li class="list-inline-item"><a href="../index.html">Home</a></li>
          </ul> {% endcomment %}
        </div>
      </div>
    </div>
  </footer>
  
  
  <script>layout_change('light');</script>
  <script>change_box_container('false');</script>
  
  <script>layout_rtl_change('false');</script>
  <script>preset_change("preset-1");</script>
  
  <script>font_change("Public-Sans");</script>
  <script src="{% static 'js/plugins/popper.min.js' %}"></script>
  <script src="{% static 'js/plugins/bootstrap.min.js' %}"></script>
  <script src="{% static 'js/plugins/simplebar.min.js' %}"></script>
  <script src="{% static 'js/fonts/custom-font.js' %}"></script>
  <script src="{% static 'js/pcoded.js' %}"></script>
  <script src="{% static 'js/plugins/feather.min.js' %}"></script>

<script>
    document.querySelectorAll('.delete').forEach(function(element) {
      element.addEventListener('click', function(event) {
        if (!confirm('Bạn có chắc chắn muốn xóa  "' + this.closest('tr').querySelector('h6').textContent + '" không?')) {
          event.preventDefault();
        }
      });
    });
</script> 
<script>
function formatVND(amount) {
  try {
    amount = parseFloat(amount);
    if (isNaN(amount)) return '0 ₫';
    return amount.toLocaleString('vi-VN') + ' ₫';
  } catch (e) {
    return '0 ₫';
  }
}


function formatDate(dateString) {
    // Bỏ dấu chấm trong tháng (nếu có)
    dateString = dateString.replace('.', '');

    let date = new Date(dateString);

    let year = date.getFullYear();
    let month = String(date.getMonth() + 1).padStart(2, '0'); // tháng từ 0-11
    let day = String(date.getDate()).padStart(2, '0');

    return `${year}-${month}-${day}`;
}

function convertToDatetimeLocal(str) {
  // Tạo đối tượng ngày từ chuỗi
  const date = new Date(str);

  // Nếu sai định dạng hoặc không parse được
  if (isNaN(date)) return null;

  // Lấy từng phần và chuẩn hóa
  const yyyy = date.getFullYear();
  const mm = String(date.getMonth() + 1).padStart(2, '0');
  const dd = String(date.getDate()).padStart(2, '0');
  const hh = String(date.getHours()).padStart(2, '0');
  const min = String(date.getMinutes()).padStart(2, '0');

  return `${yyyy}-${mm}-${dd}T${hh}:${min}`;
}
;
 
document.addEventListener('DOMContentLoaded', function () {
    // Lấy tất cả các nút có class là 'delete-btn'
    const deleteButtons = document.querySelectorAll('.delete-btn');

    // Lặp qua từng nút
    deleteButtons.forEach(button => {
        // Gắn sự kiện 'click' cho mỗi nút
        button.addEventListener('click', function (event) {
            // Ngăn chặn hành động chuyển trang mặc định của thẻ <a>
            event.preventDefault();

            // Hiển thị hộp thoại xác nhận
            const userConfirmed = confirm("Bạn có chắc chắn muốn xóa mục này không?");

            // Nếu người dùng nhấn "OK" (true)
            if (userConfirmed) {
                // Chuyển hướng đến URL xóa trong href
                window.location.href = this.href;
            }
            // Nếu người dùng nhấn "Cancel", không làm gì cả.
        });
    });
});


  document.addEventListener("DOMContentLoaded", function () {
    const alerts = document.querySelectorAll(".alert");
    alerts.forEach(function(alert) {
      setTimeout(function () {
        alert.classList.remove("show");
        alert.classList.add("hide");
        setTimeout(() => alert.remove(), 300); // Remove after fade out
      }, 5000); // 5 seconds
    });
  });
</script>


<script>
// ẩn/hiện danh sách cử tri
document.addEventListener('DOMContentLoaded', function() {
    const publicRadio = document.getElementById('add_type_public');
    const privateRadio = document.getElementById('add_type_private');
    const votersWrapper = document.getElementById('add_eligible_voters_wrapper');

    function toggleVotersList() {
        if (privateRadio.checked) {
            votersWrapper.style.display = 'block';
        } else {
            votersWrapper.style.display = 'none';
        }
    }

    publicRadio.addEventListener('change', toggleVotersList);
    privateRadio.addEventListener('change', toggleVotersList);
});
</script>

<script>
//  ẩn/hiện danh sách cử tri cho form SỬA
document.addEventListener('DOMContentLoaded', function() {
    const publicRadioEdit = document.getElementById('edit_type_public');
    const privateRadioEdit = document.getElementById('edit_type_private');
    const votersWrapperEdit = document.getElementById('edit_eligible_voters_wrapper');

    function toggleVotersListEdit() {
        if (privateRadioEdit.checked) {
            votersWrapperEdit.style.display = 'block';
        } else {
            votersWrapperEdit.style.display = 'none';
        }
    }

    publicRadioEdit.addEventListener('change', toggleVotersListEdit);
    privateRadioEdit.addEventListener('change', toggleVotersListEdit);
    

});
</script>


<script>
document.addEventListener('DOMContentLoaded', function() {
    const messageContainer = document.getElementById('message-container');
    if (messageContainer) {
        // Tìm thông báo đầu tiên để hiển thị
        const alertToShow = messageContainer.querySelector('.alert');
        
        if (alertToShow) {
            // Lấy các element của modal
            const customModalElement = document.getElementById('customMessageModal');
            const customModal = new bootstrap.Modal(customModalElement);
            const modalTitle = document.getElementById('customMessageModalLabel');
            const modalHeader = document.getElementById('customMessageModalHeader');
            const modalBody = document.getElementById('customMessageModalBody');
            
            // Lấy nội dung của thông báo
            const messageText = alertToShow.childNodes[0].textContent.trim();
            
            // Mặc định là thông báo thông tin
            let titleHTML = '<i class="ti ti-info-circle me-2 text-info"></i> Thông báo';
            let headerClass = 'modal-header';

            // Kiểm tra loại thông báo để tùy chỉnh modal
            if (alertToShow.classList.contains('alert-danger')) {
                titleHTML = '<i class="ti ti-alert-circle me-2 text-danger"></i> Đã có lỗi xảy ra';
                headerClass = 'modal-header bg-light-danger';
            } else if (alertToShow.classList.contains('alert-success')) {
                titleHTML = '<i class="ti ti-circle-check me-2 text-success"></i> Thành công!';
                headerClass = 'modal-header bg-light-success';
            } else if (alertToShow.classList.contains('alert-warning')) {
                titleHTML = '<i class="ti ti-alert-triangle me-2 text-warning"></i> Cảnh báo';
                headerClass = 'modal-header bg-light-warning';
            }

            // Cập nhật nội dung và giao diện cho modal
            if (modalTitle) modalTitle.innerHTML = titleHTML;
            if (modalHeader) modalHeader.className = headerClass;
            if (modalBody) modalBody.textContent = messageText;
            
            // Hiển thị modal
            customModal.show();

            // Ẩn đi khu vực thông báo nhỏ ban đầu
            messageContainer.style.display = 'none';
        }
    }
});
</script>

</body>
<!-- [Body] end -->

</html>