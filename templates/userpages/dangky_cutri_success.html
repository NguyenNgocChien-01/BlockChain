{% extends 'userpages/index.html' %}
{% load static %}

{% block title %}Đăng Ký Thành Công - Lưu Khóa Của Bạn{% endblock %}

{% block content %}
<div class="pc-container">
    <div class="pc-content">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="card">
                    <div class="card-body text-center">
                        <i class="ti ti-circle-check text-success" style="font-size: 60px;"></i>
                        <h2 class="mt-3">Đăng Ký Thành Công!</h2>
                        <p class="text-muted">Tài khoản và khóa của bạn đã được tạo. Vui lòng sao chép và lưu trữ các khóa dưới đây ở một nơi an toàn.</p>
                        
                        <div class="alert alert-danger mt-4" role="alert">
                            <h4 class="alert-heading">CẢNH BÁO QUAN TRỌNG</h4>
                            <p><strong>Khóa Bí Mật (Private Key)</strong> giống như mật khẩu ngân hàng của bạn. <strong>TUYỆT ĐỐI KHÔNG</strong> chia sẻ nó cho bất kỳ ai. Nếu làm mất, bạn sẽ không thể bỏ phiếu và không thể khôi phục lại.</p>
                            <hr>
                            <p class="mb-0">Đây là lần duy nhất hệ thống hiển thị Khóa Bí Mật cho bạn.</p>
                        </div>

                        <!-- Hiển thị Khóa Công Khai -->
                        <div class="mt-4">
                            <h5>Khóa Công Khai (Public Key)</h5>
                            <p class="text-muted small">Bạn có thể chia sẻ khóa này để người khác xác thực.</p>
                            <div class="input-group">
                                <textarea id="publicKey" class="form-control font-monospace" rows="5" readonly>{{ public_key }}</textarea>
                                <button class="btn btn-outline-secondary" type="button" onclick="copyToClipboard('publicKey')">Copy</button>
                            </div>
                        </div>

                        <!-- Hiển thị Khóa Bí Mật -->
                        <div class="mt-4">
                            <h5>Khóa Bí Mật (Private Key) - HÃY LƯU LẠI!</h5>
                            <div class="input-group">
                                <textarea id="privateKey" class="form-control font-monospace" rows="8" readonly>{{ private_key }}</textarea>
                                <button class="btn btn-outline-secondary" type="button" onclick="copyToClipboard('privateKey')">Copy</button>
                            </div>
                        </div>

                        <div class="d-grid mt-4">
                            <a href="{% url 'baucu_u' %}" class="btn btn-primary btn-lg">Tôi đã lưu khóa, tiếp tục đến trang chủ</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function copyToClipboard(elementId) {
    const textArea = document.getElementById(elementId);
    textArea.select();
    textArea.setSelectionRange(0, 99999); // For mobile devices
    try {
        document.execCommand('copy');
        alert('Đã sao chép vào clipboard!');
    } catch (err) {
        alert('Lỗi! Không thể sao chép.');
    }
}
</script>
{% endblock %}